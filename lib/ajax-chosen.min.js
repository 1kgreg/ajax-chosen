(function(b){return b.fn.ajaxChosen=function(c,h,d){var e,a,g;null==c&&(c={});null==h&&(h={});null==d&&(d=function(){});g=this;e=null;a=b.extend({},{minTermLength:3,afterTypeDelay:500,jsonTermKey:"term"},c);this.chosen(d?d:{});return this.each(function(){return b(this).next(".chzn-container").find(".search-field > input, .chzn-search > input").bind("keyup",function(){var d,c,i,f;f=b.trim(b(this).attr("value"));c=f.length<a.minTermLength?"Keep typing...":"Looking for '"+f+"'";g.next(".chzn-container").find(".no-results").text(c);
if(f===b(this).data("prevVal"))return!1;b(this).data("prevVal",f);this.timer&&clearTimeout(this.timer);if(f.length<a.minTermLength)return!1;d=b(this);null==a.data&&(a.data={});a.data[a.jsonTermKey]=f;null!=a.dataCallback&&(a.data=a.dataCallback(a.data));i=a.success;a.success=function(a){var c,e;if(a!=null){e=[];g.find("option").each(function(){return b(this).is(":selected")?e.push(b(this).val()+"-"+b(this).text()):b(this).remove()});c=h(a);b.each(c,function(a,c){var d;if(c.group){d=b("<optgroup />").attr("label",
c.text).appendTo(g);return b.each(c.items,function(a,c){if(b.inArray(a+"-"+c,e)===-1)return b("<option />").attr("value",a).html(c).appendTo(d)})}if(b.inArray(a+"-"+c,e)===-1)return b("<option />").attr("value",a).html(c).appendTo(g)});g.trigger("liszt:updated");i!=null&&i(a);d.attr("value",f);return d.css("width","auto")}};return this.timer=setTimeout(function(){e&&e.abort();return e=b.ajax(a)},a.afterTypeDelay)})})}})(jQuery);